name: Trivy-scan
on:
  push:
  workflow_dispatch:
  pull_request:
    branches:
      - master
  schedule:
    - cron: '5 6 * * *'  # Runs every day at 06:05 UTC

jobs:
  trivy-scan:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Code
        uses: actions/checkout@v4

      - name: Build images and run Trivy scans
        uses: CheckmarxDev/actions-workflow-template/workflows/trivy-scan@910f5c4bee4ccbc62b7fd94de00796e60027ca55
        with:
          version: 'latest'
          cache_dir: '${{ github.workspace }}/.cache/trivy'
          cache_key_prefix: 'cache-trivy'
          timeout_scan: '25m'
          timeout_scan_build: '15m'
          skip_db_update_scan: 'true'
          skip_java_db_update_scan: 'true'
          skip_db_update_scan_build: 'true'
          skip_java_db_update_scan_build: 'true'
          additional_build_args: ''
          fail_on_severity: 'CRITICAL,HIGH,MEDIUM,LOW,UNKNOWN'
          jfrog_ci_pass: ''
          jfrog_ci_user: ''
          gh_token: ''
